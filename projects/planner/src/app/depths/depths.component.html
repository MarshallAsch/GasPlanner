<div class="card">
  <div class="card-header">
      <fa-icon [icon]="cardIcon" class="mr-3"></fa-icon>
      <span *ngIf="!isComplex">Depth</span>
      <span *ngIf="isComplex">Depths</span>
  </div>
  <div class="card-body" *ngIf="!isComplex">
    <div class="form-group">
      <label for="duration">Bottom time [min.]:
        <input id="duration" name="duration" #duration="ngModel" [(ngModel)]="planDuration" class="form-control" type="number"
          required [class.is-invalid]="duration.invalid && (duration.dirty || duration.touched)"/>
      </label>
      <div class="text-danger" *ngIf="duration.invalid && (duration.dirty || duration.touched)">Needs to be number > 0 min.</div>
    </div>

    <div class="form-group">
      <label for="depth">Depth [m]:
        <input id="depth" name="depth" #depth="ngModel" [(ngModel)]="plannedDepth" class="form-control" type="number"
          required [class.is-invalid]="depth.invalid && (depth.dirty || depth.touched)"/>
        <div><small class="text-muted">No deco limit {{ noDecoTime | number:'1.0-0' }} min.</small></div>
        <div><small class="text-muted">Best mix is {{ bestMix }}</small></div>
        <div class="text-danger" *ngIf="depth.invalid && (depth.dirty || depth.touched)">Needs to be number 1 - 500 m</div>
      </label>
    </div>
  </div>
  <div class="card-body" *ngIf="isComplex">
    <table class="table table-noheader">
        <tr>
          <th class="mx-0 px-1">From [m]</th>
          <th class="mx-0 px-1">To [m]</th>
          <th class="mx-0 px-1">Duration [min]</th>
          <th class="mx-0 px-1">Tank</th>
          <th class="mx-0 px-1"><button class="btn btn-sm m-0 p-0" type="button" (click)="addSegment()"><fa-icon [icon]="addIcon"></fa-icon></button></th>
        </tr>
        <tr *ngFor="let level of levels">
            <td class="mx-0 px-1">{{ level.startDepth | number:'1.0-0' }}</td>
            <td class="mx-0 px-1">
                <input #endDepth="ngModel" name="endDepth" [(ngModel)]="level.endDepth" class="form-control" type="number" (change)="depthChanged()"
                required step="1"
                [class.is-invalid]="endDepth.invalid && (endDepth.dirty || endDepth.touched)"/>
                <div class="text-danger" *ngIf="endDepth.invalid && (endDepth.dirty || endDepth.touched)">Needs to be number 0-300 m</div>
            </td>
            <td class="mx-0 px-1">
                <input #duration2="ngModel" name="duration2" [(ngModel)]="level.duration" class="form-control" type="number" (change)="durationChanged()"
                 required step="1"
                [class.is-invalid]="duration2.invalid && (duration2.dirty || duration2.touched)"/>
                <div class="text-danger" *ngIf="duration2.invalid && (duration2.dirty || duration2.touched)">Needs to be number 0-1440 min</div>
            </td>
            <td class="mx-0 px-1">
                <div class="input-group">
                    <input id="strategy" [ngModel]="level.tankLabel" class="form-control" type="text" readonly />
                    <div ngbDropdown class="input-group-append d-inline-block" placement="bottom-right">
                        <button class="btn btn-default border" id="tankMenu" type="button" ngbDropdownToggle></button>
                        <div ngbDropdownMenu aria-labelledby="tankMenu" aria-expanded="false">
                        <button *ngFor="let tank of tanks" type="button" class="dropdown-item" (click)="assignTank(level, tank)">{{ tankLabel(tank) }}</button>
                        </div>
                    </div>
                </div>
            </td>
            <td class="mx-0 px-0"><button *ngIf="minimumSegments" type="button" class="btn btn-sm m-0 p-0" (click)="removeSegment(level)"><fa-icon [icon]="removeIcon"></fa-icon></button></td>
        </tr>
    </table>
  </div>
</div>
